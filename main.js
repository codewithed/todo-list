(()=>{"use strict";const t=(t,e,n,a,o)=>({title:t,dueDate:e,description:n,priority:a,completedStatus:o,editTitle(t){this.title=t},editDescription(t){this.description=t},editPriority(t){this.priority=t},editDueDate(t){this.dueDate=t},editCompletedStatus(t){this.completedStatus=t}}),e=function(){this.arr=[],this.addProject=t=>{this.arr.push(t)},this.removeProject=t=>{this.arr.splice(t,1)}};function n(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function o(t){n(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===a(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function i(t){n(1,arguments);var e=o(t);return e.setHours(0,0,0,0),e}function s(t,e){n(2,arguments);var a=i(t),o=i(e);return a.getTime()===o.getTime()}function d(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}var r={};function c(){return r}function l(t,e){var a,i,s,r,l,u,m,p;n(1,arguments);var y=c(),f=d(null!==(a=null!==(i=null!==(s=null!==(r=null==e?void 0:e.weekStartsOn)&&void 0!==r?r:null==e||null===(l=e.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==s?s:y.weekStartsOn)&&void 0!==i?i:null===(m=y.locale)||void 0===m||null===(p=m.options)||void 0===p?void 0:p.weekStartsOn)&&void 0!==a?a:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=o(t),v=g.getDay(),b=(v<f?7:0)+v-f;return g.setDate(g.getDate()-b),g.setHours(0,0,0,0),g}function u(t,e,a){n(2,arguments);var o=l(t,a),i=l(e,a);return o.getTime()===i.getTime()}const m=function(t){this.name=t,this.arr=[],this.addTask=t=>{this.arr.push(t)},this.removeTask=t=>{this.arr.splice(t,1)},this.getTodayTasks=()=>{this.filter((t=>function(t){return n(1,arguments),s(t,Date.now())}(t.dueDate)))},this.getWeeklyTasks=()=>{this.arr.filter((t=>function(t,e){return n(1,arguments),u(t,Date.now(),e)}(t.dueDate)))},this.pastDueTasks=()=>{this.arr.filter((t=>function(t){return n(1,arguments),o(t).getTime()<Date.now()}(t.dueDate)))}};!function(){const n=new m("defaultProject");let a=n;const o=new e;function i(t){document.getElementById("tasklist").innerHTML="",document.getElementById("projectTitle").innerText=t}function s(t){t.forEach((t=>{const e=document.getElementById("tasklist"),n=document.createElement("button");n.classList.add("todo-item"),n.innerHTML=`<div class="left-task-panel"><i class="fa-regular fa-circle"></i><p class="todo-title">${t.title}</p><input type="text" class="input-task-name" data-input-task-name=""></div>\n      <div class="right-task-panel"><p class='due-date'>${t.dueDate}</p><input type="date" name="" id="inputDueDate" class="input-date" data-input-date><i class="fa-solid fa-xmark"></i></i></div>`;const o=a.arr.length;n.setAttribute("data-index",o),e.append(n),n.addEventListener("click",c)}))}function d(){const t=document.getElementById("projectTitle").value;if(void 0===t||""===t)alert("Project name can't be empty");else{const e=document.getElementById("projectPrompt"),d=new m(t);o.addProject(d);const r=document.getElementById("userProjects"),c=document.createElement("button");c.classList.add("project-button"),c.style.id="projectButton",c.setAttribute("data-index",o.arr.length-1),c.innerHTML=`<div class="left-project-panel"><i class="fa-solid fa-list"></i><span>&nbsp${t}</span></div>\n     <div class="right-project-panel"><i class="fa-solid fa-xmark"></i></div>`,r.appendChild(c),document.getElementById("addProjectBtn").style.display="block",e.remove(),c.addEventListener("click",(()=>{a=d,i(d.name),s(a.arr)})),c.addEventListener("click",(t=>{!function(t){if(t.target.classList.contains("fa-xmark")){const e=t.target.parentElement.parentElement,d=e.dataset.index;o.removeProject(d),e.remove(),t.stopPropagation(),a=n,i("Inbox"),s(a.arr)}}(t)}))}}function r(){const t=document.getElementById("addProjectBtn");document.getElementById("projectPrompt").remove(),t.style.display="block"}function c(t){if(t.target.classList.contains("fa-xmark")){const e=t.target.parentElement.parentElement;e.remove();const n=e.dataset.index;a.removeTask(n)}}function l(t){if(t.target.classList.contains("todo-title")||t.target.classList.contains("due-date")){const e=t.target;e.style.display="none";const n=t.target.parentElement.querySelector("input");n.classList.add("active"),document.addEventListener("keyup",(t=>{if("Enter"===t.key){const t=n.value;if(""===t||void 0===e)alert("Value cannot be empty");else{n.classList.remove("active"),e.style.display="block";const{index:o}=e.parentElement.parentElement.dataset;e.innerText=t,e.classList.contains("todo-title")&&a.arr[o].editTitle(t),e.classList.contains("due-date")&&a.arr[o].editDueDate(t)}}}))}}function u(){const e=document.getElementById("todoPrompt"),n=document.getElementById("taskTitle").value;if(void 0===n||""===n||null===n)alert("Task name cannot be empty");else{const o=t(n);a.addTask(o),e.remove();const i=document.createElement("button");i.classList.add("todo-item"),i.innerHTML=`<div class="left-task-panel"><i class="fa-regular fa-circle"></i><p class="todo-title">${n}</p><input type="text" class="input-task-name" data-input-task-name=""></div>\n      <div class="right-task-panel"><p class="due-date">No Date</p><input type="date" name="" id="inputDueDate" class="input-date" data-input-date><i class="fa-solid fa-xmark"></i></i></div>`;const s=document.getElementById("tasklist"),d=a.arr.length-1;i.setAttribute("data-index",d),s.append(i),i.addEventListener("click",c),i.addEventListener("click",l),document.getElementById("addTodoBtn").style.display="block"}}function p(){document.getElementById("todoPrompt").remove(),document.getElementById("addTodoBtn").style.display="block"}function y(){s(n.arr)}document.getElementById("addProjectBtn").addEventListener("click",(function(){const t=document.createElement("div"),e=document.getElementById("userProjects");t.setAttribute("id","projectPrompt");const n=document.getElementById("addProjectBtn");t.classList.add("project-prompt"),t.innerHTML='<input type="text" value="" placeholder="project title" id=\'projectTitle\'>\n   <div><button id="add" style="background-color: rgb(123, 237, 157);">Add</button>\n   <button id="cancel" style="background-color: rgb(247, 95, 95)">Cancel</button></div>',e.append(t),n.style.display="none";const a=document.getElementById("add"),o=document.getElementById("cancel");a.addEventListener("click",d),o.addEventListener("click",r)})),document.getElementById("addTodoBtn").addEventListener("click",(function(){document.getElementById("addTodoBtn").style.display="none";const t=document.createElement("div");t.setAttribute("id","todoPrompt"),t.classList.add("project-prompt"),t.innerHTML='<input type="text" value="" placeholder="task title" id=\'taskTitle\'>\n    <div><button id="add" style="background-color: rgb(123, 237, 157);">Add</button>\n    <button id="cancel" style="background-color: rgb(247, 95, 95)">Cancel</button></div>',document.getElementById("tasklist").appendChild(t);const e=document.getElementById("add"),n=document.getElementById("cancel");e.addEventListener("click",u),n.addEventListener("click",p)})),document.getElementById("inboxBtn").addEventListener("click",(()=>{a=n,i("Inbox"),y()})),i("Inbox"),y()}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxrQkFDekJtQyxFQUFXNUMsVUFBWSx5UEFHSEYsU0FBU0MsZUFBZSxZQUNoQ3dCLFlBQVlxQixHQUV4QixNQUFNbkMsRUFBTVgsU0FBU0MsZUFBZSxPQUM5QmtELEVBQVNuRCxTQUFTQyxlQUFlLFVBRXZDVSxFQUFJRyxpQkFBaUIsUUFBUytCLEdBQzlCTSxFQUFPckMsaUJBQWlCLFFBQVNtQyxFQUNuQyxJQXFJaUJqRCxTQUFTQyxlQUFlLFlBQ2hDYSxpQkFBaUIsU0FBUyxLQUNqQ2pCLEVBQWlCRCxFQUNqQkcsRUFBYyxTQUNkbUQsR0FBZSxJQW1CakJuRCxFQUFjLFNBQ2RtRCxHQUNGLENDdlNBRSxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVG9kby5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9wcm9qZWN0bGlzdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vdG9EYXRlL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vc3RhcnRPZkRheS9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzU2FtZURheS9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvdG9JbnRlZ2VyL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vX2xpYi9kZWZhdWx0T3B0aW9ucy9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL3N0YXJ0T2ZXZWVrL2luZGV4LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vaXNTYW1lV2Vlay9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9wcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL25vZGVfbW9kdWxlcy9kYXRlLWZucy9lc20vaXNUb2RheS9pbmRleC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzVGhpc1dlZWsvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc1Bhc3QvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvZG9tc3R1ZmYuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG5ld1RvZG8gPSAodGl0bGUsIGR1ZURhdGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eSwgY29tcGxldGVkU3RhdHVzKSA9PiAoe1xuICB0aXRsZSxcbiAgZHVlRGF0ZSxcbiAgZGVzY3JpcHRpb24sXG4gIHByaW9yaXR5LFxuICBjb21wbGV0ZWRTdGF0dXMsXG5cbiAgZWRpdFRpdGxlKG5ld1RpdGxlKSB7XG4gICAgdGhpcy50aXRsZSA9IG5ld1RpdGxlO1xuICB9LFxuICBlZGl0RGVzY3JpcHRpb24obmV3RGVzYykge1xuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBuZXdEZXNjO1xuICB9LFxuICBlZGl0UHJpb3JpdHkobmV3UHJpb3JpdHkpIHtcbiAgICB0aGlzLnByaW9yaXR5ID0gbmV3UHJpb3JpdHk7XG4gIH0sXG4gIGVkaXREdWVEYXRlKG5ld0R1ZURhdGUpIHtcbiAgICB0aGlzLmR1ZURhdGUgPSBuZXdEdWVEYXRlO1xuICB9LFxuICBlZGl0Q29tcGxldGVkU3RhdHVzKG5ld0NvbXBsZXRlZFN0YXR1cykge1xuICAgIHRoaXMuY29tcGxldGVkU3RhdHVzID0gbmV3Q29tcGxldGVkU3RhdHVzO1xuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IG5ld1RvZG87XG4iLCJmdW5jdGlvbiBQcm9qZWN0TGlzdCgpIHtcbiAgdGhpcy5hcnIgPSBbXTtcblxuICB0aGlzLmFkZFByb2plY3QgPSAocHJvamVjdCkgPT4ge1xuICAgIHRoaXMuYXJyLnB1c2gocHJvamVjdCk7XG4gIH07XG5cbiAgdGhpcy5yZW1vdmVQcm9qZWN0ID0gKGluZGV4KSA9PiB7XG4gICAgdGhpcy5hcnIuc3BsaWNlKGluZGV4LCAxKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgUHJvamVjdExpc3Q7XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXF1aXJlZEFyZ3MocmVxdWlyZWQsIGFyZ3MpIHtcbiAgaWYgKGFyZ3MubGVuZ3RoIDwgcmVxdWlyZWQpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHJlcXVpcmVkICsgJyBhcmd1bWVudCcgKyAocmVxdWlyZWQgPiAxID8gJ3MnIDogJycpICsgJyByZXF1aXJlZCwgYnV0IG9ubHkgJyArIGFyZ3MubGVuZ3RoICsgJyBwcmVzZW50Jyk7XG4gIH1cbn0iLCJmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgfSByZXR1cm4gX3R5cGVvZihvYmopOyB9XG5cbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIHRvRGF0ZVxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBDb252ZXJ0IHRoZSBnaXZlbiBhcmd1bWVudCB0byBhbiBpbnN0YW5jZSBvZiBEYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYW4gaW5zdGFuY2Ugb2YgRGF0ZSwgdGhlIGZ1bmN0aW9uIHJldHVybnMgaXRzIGNsb25lLlxuICpcbiAqIElmIHRoZSBhcmd1bWVudCBpcyBhIG51bWJlciwgaXQgaXMgdHJlYXRlZCBhcyBhIHRpbWVzdGFtcC5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgbm9uZSBvZiB0aGUgYWJvdmUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIEludmFsaWQgRGF0ZS5cbiAqXG4gKiAqKk5vdGUqKjogKmFsbCogRGF0ZSBhcmd1bWVudHMgcGFzc2VkIHRvIGFueSAqZGF0ZS1mbnMqIGZ1bmN0aW9uIGlzIHByb2Nlc3NlZCBieSBgdG9EYXRlYC5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBhcmd1bWVudCAtIHRoZSB2YWx1ZSB0byBjb252ZXJ0XG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIHBhcnNlZCBkYXRlIGluIHRoZSBsb2NhbCB0aW1lIHpvbmVcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDbG9uZSB0aGUgZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZShuZXcgRGF0ZSgyMDE0LCAxLCAxMSwgMTEsIDMwLCAzMCkpXG4gKiAvLz0+IFR1ZSBGZWIgMTEgMjAxNCAxMTozMDozMFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBDb252ZXJ0IHRoZSB0aW1lc3RhbXAgdG8gZGF0ZTpcbiAqIGNvbnN0IHJlc3VsdCA9IHRvRGF0ZSgxMzkyMDk4NDMwMDAwKVxuICogLy89PiBUdWUgRmViIDExIDIwMTQgMTE6MzA6MzBcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0b0RhdGUoYXJndW1lbnQpIHtcbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHZhciBhcmdTdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJndW1lbnQpOyAvLyBDbG9uZSB0aGUgZGF0ZVxuXG4gIGlmIChhcmd1bWVudCBpbnN0YW5jZW9mIERhdGUgfHwgX3R5cGVvZihhcmd1bWVudCkgPT09ICdvYmplY3QnICYmIGFyZ1N0ciA9PT0gJ1tvYmplY3QgRGF0ZV0nKSB7XG4gICAgLy8gUHJldmVudCB0aGUgZGF0ZSB0byBsb3NlIHRoZSBtaWxsaXNlY29uZHMgd2hlbiBwYXNzZWQgdG8gbmV3IERhdGUoKSBpbiBJRTEwXG4gICAgcmV0dXJuIG5ldyBEYXRlKGFyZ3VtZW50LmdldFRpbWUoKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50ID09PSAnbnVtYmVyJyB8fCBhcmdTdHIgPT09ICdbb2JqZWN0IE51bWJlcl0nKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGFyZ3VtZW50KTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoKHR5cGVvZiBhcmd1bWVudCA9PT0gJ3N0cmluZycgfHwgYXJnU3RyID09PSAnW29iamVjdCBTdHJpbmddJykgJiYgdHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS53YXJuKFwiU3RhcnRpbmcgd2l0aCB2Mi4wLjAtYmV0YS4xIGRhdGUtZm5zIGRvZXNuJ3QgYWNjZXB0IHN0cmluZ3MgYXMgZGF0ZSBhcmd1bWVudHMuIFBsZWFzZSB1c2UgYHBhcnNlSVNPYCB0byBwYXJzZSBzdHJpbmdzLiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9kYXRlLWZucy9kYXRlLWZucy9ibG9iL21hc3Rlci9kb2NzL3VwZ3JhZGVHdWlkZS5tZCNzdHJpbmctYXJndW1lbnRzXCIpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuXG4gICAgICBjb25zb2xlLndhcm4obmV3IEVycm9yKCkuc3RhY2spO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRGF0ZShOYU4pO1xuICB9XG59IiwiaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBzdGFydE9mRGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IFJldHVybiB0aGUgc3RhcnQgb2YgYSBkYXkgZm9yIHRoZSBnaXZlbiBkYXRlLlxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogUmV0dXJuIHRoZSBzdGFydCBvZiBhIGRheSBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKiBUaGUgcmVzdWx0IHdpbGwgYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgb3JpZ2luYWwgZGF0ZVxuICogQHJldHVybnMge0RhdGV9IHRoZSBzdGFydCBvZiBhIGRheVxuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFRoZSBzdGFydCBvZiBhIGRheSBmb3IgMiBTZXB0ZW1iZXIgMjAxNCAxMTo1NTowMDpcbiAqIGNvbnN0IHJlc3VsdCA9IHN0YXJ0T2ZEYXkobmV3IERhdGUoMjAxNCwgOCwgMiwgMTEsIDU1LCAwKSlcbiAqIC8vPT4gVHVlIFNlcCAwMiAyMDE0IDAwOjAwOjAwXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhcnRPZkRheShkaXJ0eURhdGUpIHtcbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHZhciBkYXRlID0gdG9EYXRlKGRpcnR5RGF0ZSk7XG4gIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIHJldHVybiBkYXRlO1xufSIsImltcG9ydCBzdGFydE9mRGF5IGZyb20gXCIuLi9zdGFydE9mRGF5L2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc1NhbWVEYXlcbiAqIEBjYXRlZ29yeSBEYXkgSGVscGVyc1xuICogQHN1bW1hcnkgQXJlIHRoZSBnaXZlbiBkYXRlcyBpbiB0aGUgc2FtZSBkYXkgKGFuZCB5ZWFyIGFuZCBtb250aCk/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIGRheSAoYW5kIHllYXIgYW5kIG1vbnRoKT9cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlTGVmdCAtIHRoZSBmaXJzdCBkYXRlIHRvIGNoZWNrXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlUmlnaHQgLSB0aGUgc2Vjb25kIGRhdGUgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtCb29sZWFufSB0aGUgZGF0ZXMgYXJlIGluIHRoZSBzYW1lIGRheSAoYW5kIHllYXIgYW5kIG1vbnRoKVxuICogQHRocm93cyB7VHlwZUVycm9yfSAyIGFyZ3VtZW50cyByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgNCBTZXB0ZW1iZXIgMDY6MDA6MDAgYW5kIDQgU2VwdGVtYmVyIDE4OjAwOjAwIGluIHRoZSBzYW1lIGRheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZURheShuZXcgRGF0ZSgyMDE0LCA4LCA0LCA2LCAwKSwgbmV3IERhdGUoMjAxNCwgOCwgNCwgMTgsIDApKVxuICogLy89PiB0cnVlXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSA0IFNlcHRlbWJlciBhbmQgNCBPY3RvYmVyIGluIHRoZSBzYW1lIGRheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZURheShuZXcgRGF0ZSgyMDE0LCA4LCA0KSwgbmV3IERhdGUoMjAxNCwgOSwgNCkpXG4gKiAvLz0+IGZhbHNlXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSA0IFNlcHRlbWJlciwgMjAxNCBhbmQgNCBTZXB0ZW1iZXIsIDIwMTUgaW4gdGhlIHNhbWUgZGF5P1xuICogY29uc3QgcmVzdWx0ID0gaXNTYW1lRGF5KG5ldyBEYXRlKDIwMTQsIDgsIDQpLCBuZXcgRGF0ZSgyMDE1LCA4LCA0KSlcbiAqIC8vPT4gZmFsc2VcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1NhbWVEYXkoZGlydHlEYXRlTGVmdCwgZGlydHlEYXRlUmlnaHQpIHtcbiAgcmVxdWlyZWRBcmdzKDIsIGFyZ3VtZW50cyk7XG4gIHZhciBkYXRlTGVmdFN0YXJ0T2ZEYXkgPSBzdGFydE9mRGF5KGRpcnR5RGF0ZUxlZnQpO1xuICB2YXIgZGF0ZVJpZ2h0U3RhcnRPZkRheSA9IHN0YXJ0T2ZEYXkoZGlydHlEYXRlUmlnaHQpO1xuICByZXR1cm4gZGF0ZUxlZnRTdGFydE9mRGF5LmdldFRpbWUoKSA9PT0gZGF0ZVJpZ2h0U3RhcnRPZkRheS5nZXRUaW1lKCk7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdG9JbnRlZ2VyKGRpcnR5TnVtYmVyKSB7XG4gIGlmIChkaXJ0eU51bWJlciA9PT0gbnVsbCB8fCBkaXJ0eU51bWJlciA9PT0gdHJ1ZSB8fCBkaXJ0eU51bWJlciA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm4gTmFOO1xuICB9XG5cbiAgdmFyIG51bWJlciA9IE51bWJlcihkaXJ0eU51bWJlcik7XG5cbiAgaWYgKGlzTmFOKG51bWJlcikpIHtcbiAgICByZXR1cm4gbnVtYmVyO1xuICB9XG5cbiAgcmV0dXJuIG51bWJlciA8IDAgPyBNYXRoLmNlaWwobnVtYmVyKSA6IE1hdGguZmxvb3IobnVtYmVyKTtcbn0iLCJ2YXIgZGVmYXVsdE9wdGlvbnMgPSB7fTtcbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0T3B0aW9ucygpIHtcbiAgcmV0dXJuIGRlZmF1bHRPcHRpb25zO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHNldERlZmF1bHRPcHRpb25zKG5ld09wdGlvbnMpIHtcbiAgZGVmYXVsdE9wdGlvbnMgPSBuZXdPcHRpb25zO1xufSIsImltcG9ydCB0b0RhdGUgZnJvbSBcIi4uL3RvRGF0ZS9pbmRleC5qc1wiO1xuaW1wb3J0IHRvSW50ZWdlciBmcm9tIFwiLi4vX2xpYi90b0ludGVnZXIvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG5pbXBvcnQgeyBnZXREZWZhdWx0T3B0aW9ucyB9IGZyb20gXCIuLi9fbGliL2RlZmF1bHRPcHRpb25zL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIHN0YXJ0T2ZXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgd2VlayBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgd2VlayBmb3IgdGhlIGdpdmVuIGRhdGUuXG4gKiBUaGUgcmVzdWx0IHdpbGwgYmUgaW4gdGhlIGxvY2FsIHRpbWV6b25lLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgb3JpZ2luYWwgZGF0ZVxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIGFuIG9iamVjdCB3aXRoIG9wdGlvbnMuXG4gKiBAcGFyYW0ge0xvY2FsZX0gW29wdGlvbnMubG9jYWxlPWRlZmF1bHRMb2NhbGVdIC0gdGhlIGxvY2FsZSBvYmplY3QuIFNlZSBbTG9jYWxlXXtAbGluayBodHRwczovL2RhdGUtZm5zLm9yZy9kb2NzL0xvY2FsZX1cbiAqIEBwYXJhbSB7MHwxfDJ8M3w0fDV8Nn0gW29wdGlvbnMud2Vla1N0YXJ0c09uPTBdIC0gdGhlIGluZGV4IG9mIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWsgKDAgLSBTdW5kYXkpXG4gKiBAcmV0dXJucyB7RGF0ZX0gdGhlIHN0YXJ0IG9mIGEgd2Vla1xuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKiBAdGhyb3dzIHtSYW5nZUVycm9yfSBgb3B0aW9ucy53ZWVrU3RhcnRzT25gIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA2XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFRoZSBzdGFydCBvZiBhIHdlZWsgZm9yIDIgU2VwdGVtYmVyIDIwMTQgMTE6NTU6MDA6XG4gKiBjb25zdCByZXN1bHQgPSBzdGFydE9mV2VlayhuZXcgRGF0ZSgyMDE0LCA4LCAyLCAxMSwgNTUsIDApKVxuICogLy89PiBTdW4gQXVnIDMxIDIwMTQgMDA6MDA6MDBcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdGhlIHdlZWsgc3RhcnRzIG9uIE1vbmRheSwgdGhlIHN0YXJ0IG9mIHRoZSB3ZWVrIGZvciAyIFNlcHRlbWJlciAyMDE0IDExOjU1OjAwOlxuICogY29uc3QgcmVzdWx0ID0gc3RhcnRPZldlZWsobmV3IERhdGUoMjAxNCwgOCwgMiwgMTEsIDU1LCAwKSwgeyB3ZWVrU3RhcnRzT246IDEgfSlcbiAqIC8vPT4gTW9uIFNlcCAwMSAyMDE0IDAwOjAwOjAwXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc3RhcnRPZldlZWsoZGlydHlEYXRlLCBvcHRpb25zKSB7XG4gIHZhciBfcmVmLCBfcmVmMiwgX3JlZjMsIF9vcHRpb25zJHdlZWtTdGFydHNPbiwgX29wdGlvbnMkbG9jYWxlLCBfb3B0aW9ucyRsb2NhbGUkb3B0aW8sIF9kZWZhdWx0T3B0aW9ucyRsb2NhbCwgX2RlZmF1bHRPcHRpb25zJGxvY2FsMjtcblxuICByZXF1aXJlZEFyZ3MoMSwgYXJndW1lbnRzKTtcbiAgdmFyIGRlZmF1bHRPcHRpb25zID0gZ2V0RGVmYXVsdE9wdGlvbnMoKTtcbiAgdmFyIHdlZWtTdGFydHNPbiA9IHRvSW50ZWdlcigoX3JlZiA9IChfcmVmMiA9IChfcmVmMyA9IChfb3B0aW9ucyR3ZWVrU3RhcnRzT24gPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMud2Vla1N0YXJ0c09uKSAhPT0gbnVsbCAmJiBfb3B0aW9ucyR3ZWVrU3RhcnRzT24gIT09IHZvaWQgMCA/IF9vcHRpb25zJHdlZWtTdGFydHNPbiA6IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9vcHRpb25zJGxvY2FsZSA9IG9wdGlvbnMubG9jYWxlKSA9PT0gbnVsbCB8fCBfb3B0aW9ucyRsb2NhbGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfb3B0aW9ucyRsb2NhbGUkb3B0aW8gPSBfb3B0aW9ucyRsb2NhbGUub3B0aW9ucykgPT09IG51bGwgfHwgX29wdGlvbnMkbG9jYWxlJG9wdGlvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3B0aW9ucyRsb2NhbGUkb3B0aW8ud2Vla1N0YXJ0c09uKSAhPT0gbnVsbCAmJiBfcmVmMyAhPT0gdm9pZCAwID8gX3JlZjMgOiBkZWZhdWx0T3B0aW9ucy53ZWVrU3RhcnRzT24pICE9PSBudWxsICYmIF9yZWYyICE9PSB2b2lkIDAgPyBfcmVmMiA6IChfZGVmYXVsdE9wdGlvbnMkbG9jYWwgPSBkZWZhdWx0T3B0aW9ucy5sb2NhbGUpID09PSBudWxsIHx8IF9kZWZhdWx0T3B0aW9ucyRsb2NhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9kZWZhdWx0T3B0aW9ucyRsb2NhbDIgPSBfZGVmYXVsdE9wdGlvbnMkbG9jYWwub3B0aW9ucykgPT09IG51bGwgfHwgX2RlZmF1bHRPcHRpb25zJGxvY2FsMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RlZmF1bHRPcHRpb25zJGxvY2FsMi53ZWVrU3RhcnRzT24pICE9PSBudWxsICYmIF9yZWYgIT09IHZvaWQgMCA/IF9yZWYgOiAwKTsgLy8gVGVzdCBpZiB3ZWVrU3RhcnRzT24gaXMgYmV0d2VlbiAwIGFuZCA2IF9hbmRfIGlzIG5vdCBOYU5cblxuICBpZiAoISh3ZWVrU3RhcnRzT24gPj0gMCAmJiB3ZWVrU3RhcnRzT24gPD0gNikpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignd2Vla1N0YXJ0c09uIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA2IGluY2x1c2l2ZWx5Jyk7XG4gIH1cblxuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgdmFyIGRpZmYgPSAoZGF5IDwgd2Vla1N0YXJ0c09uID8gNyA6IDApICsgZGF5IC0gd2Vla1N0YXJ0c09uO1xuICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSBkaWZmKTtcbiAgZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgcmV0dXJuIGRhdGU7XG59IiwiaW1wb3J0IHN0YXJ0T2ZXZWVrIGZyb20gXCIuLi9zdGFydE9mV2Vlay9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcblxuLyoqXG4gKiBAbmFtZSBpc1NhbWVXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWsgKGFuZCBtb250aCBhbmQgeWVhcik/XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBBcmUgdGhlIGdpdmVuIGRhdGVzIGluIHRoZSBzYW1lIHdlZWsgKGFuZCBtb250aCBhbmQgeWVhcik/XG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZUxlZnQgLSB0aGUgZmlyc3QgZGF0ZSB0byBjaGVja1xuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZVJpZ2h0IC0gdGhlIHNlY29uZCBkYXRlIHRvIGNoZWNrXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIC0gYW4gb2JqZWN0IHdpdGggb3B0aW9ucy5cbiAqIEBwYXJhbSB7TG9jYWxlfSBbb3B0aW9ucy5sb2NhbGU9ZGVmYXVsdExvY2FsZV0gLSB0aGUgbG9jYWxlIG9iamVjdC4gU2VlIFtMb2NhbGVde0BsaW5rIGh0dHBzOi8vZGF0ZS1mbnMub3JnL2RvY3MvTG9jYWxlfVxuICogQHBhcmFtIHswfDF8MnwzfDR8NXw2fSBbb3B0aW9ucy53ZWVrU3RhcnRzT249MF0gLSB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGRheSBvZiB0aGUgd2VlayAoMCAtIFN1bmRheSlcbiAqIEByZXR1cm5zIHtCb29sZWFufSB0aGUgZGF0ZXMgYXJlIGluIHRoZSBzYW1lIHdlZWsgKGFuZCBtb250aCBhbmQgeWVhcilcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMiBhcmd1bWVudHMgcmVxdWlyZWRcbiAqIEB0aHJvd3Mge1JhbmdlRXJyb3J9IGBvcHRpb25zLndlZWtTdGFydHNPbmAgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDZcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDMxIEF1Z3VzdCAyMDE0IGFuZCA0IFNlcHRlbWJlciAyMDE0IGluIHRoZSBzYW1lIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVXZWVrKG5ldyBEYXRlKDIwMTQsIDcsIDMxKSwgbmV3IERhdGUoMjAxNCwgOCwgNCkpXG4gKiAvLz0+IHRydWVcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgd2VlayBzdGFydHMgd2l0aCBNb25kYXksXG4gKiAvLyBhcmUgMzEgQXVndXN0IDIwMTQgYW5kIDQgU2VwdGVtYmVyIDIwMTQgaW4gdGhlIHNhbWUgd2Vlaz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZVdlZWsobmV3IERhdGUoMjAxNCwgNywgMzEpLCBuZXcgRGF0ZSgyMDE0LCA4LCA0KSwge1xuICogICB3ZWVrU3RhcnRzT246IDFcbiAqIH0pXG4gKiAvLz0+IGZhbHNlXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIEFyZSAxIEphbnVhcnkgMjAxNCBhbmQgMSBKYW51YXJ5IDIwMTUgaW4gdGhlIHNhbWUgd2Vlaz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZVdlZWsobmV3IERhdGUoMjAxNCwgMCwgMSksIG5ldyBEYXRlKDIwMTUsIDAsIDEpKVxuICogLy89PiBmYWxzZVxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1NhbWVXZWVrKGRpcnR5RGF0ZUxlZnQsIGRpcnR5RGF0ZVJpZ2h0LCBvcHRpb25zKSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZUxlZnRTdGFydE9mV2VlayA9IHN0YXJ0T2ZXZWVrKGRpcnR5RGF0ZUxlZnQsIG9wdGlvbnMpO1xuICB2YXIgZGF0ZVJpZ2h0U3RhcnRPZldlZWsgPSBzdGFydE9mV2VlayhkaXJ0eURhdGVSaWdodCwgb3B0aW9ucyk7XG4gIHJldHVybiBkYXRlTGVmdFN0YXJ0T2ZXZWVrLmdldFRpbWUoKSA9PT0gZGF0ZVJpZ2h0U3RhcnRPZldlZWsuZ2V0VGltZSgpO1xufSIsImltcG9ydCB7XG4gIGlzVG9kYXksIGlzVGhpc1dlZWssIGlzUGFzdCxcbn0gZnJvbSAnZGF0ZS1mbnMnO1xuXG4vLyBwcm9qZWN0IGZhY3RvcnkgZnVuY3Rpb25cbmZ1bmN0aW9uIFByb2plY3QocHJvamVjdE5hbWUpIHtcbiAgdGhpcy5uYW1lID0gcHJvamVjdE5hbWU7XG4gIHRoaXMuYXJyID0gW107XG4gIHRoaXMuYWRkVGFzayA9ICh0b2RvKSA9PiB7XG4gICAgdGhpcy5hcnIucHVzaCh0b2RvKTtcbiAgfTtcbiAgdGhpcy5yZW1vdmVUYXNrID0gKGluZGV4KSA9PiB7XG4gICAgdGhpcy5hcnIuc3BsaWNlKGluZGV4LCAxKTtcbiAgfTtcbiAgdGhpcy5nZXRUb2RheVRhc2tzID0gKCkgPT4ge1xuICAgIHRoaXMuZmlsdGVyKCh0YXNrKSA9PiBpc1RvZGF5KHRhc2suZHVlRGF0ZSkpO1xuICB9O1xuICB0aGlzLmdldFdlZWtseVRhc2tzID0gKCkgPT4ge1xuICAgIHRoaXMuYXJyLmZpbHRlcigodGFzaykgPT4gaXNUaGlzV2Vlayh0YXNrLmR1ZURhdGUpKTtcbiAgfTtcbiAgdGhpcy5wYXN0RHVlVGFza3MgPSAoKSA9PiB7XG4gICAgdGhpcy5hcnIuZmlsdGVyKCh0YXNrKSA9PiBpc1Bhc3QodGFzay5kdWVEYXRlKSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFByb2plY3Q7XG4iLCJpbXBvcnQgaXNTYW1lRGF5IGZyb20gXCIuLi9pc1NhbWVEYXkvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIGlzVG9kYXlcbiAqIEBjYXRlZ29yeSBEYXkgSGVscGVyc1xuICogQHN1bW1hcnkgSXMgdGhlIGdpdmVuIGRhdGUgdG9kYXk/XG4gKiBAcHVyZSBmYWxzZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSXMgdGhlIGdpdmVuIGRhdGUgdG9kYXk/XG4gKlxuICogPiDimqDvuI8gUGxlYXNlIG5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzIG5vdCBwcmVzZW50IGluIHRoZSBGUCBzdWJtb2R1bGUgYXNcbiAqID4gaXQgdXNlcyBgRGF0ZS5ub3coKWAgaW50ZXJuYWxseSBoZW5jZSBpbXB1cmUgYW5kIGNhbid0IGJlIHNhZmVseSBjdXJyaWVkLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgZGF0ZSB0byBjaGVja1xuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlIGlzIHRvZGF5XG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDEgYXJndW1lbnQgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gSWYgdG9kYXkgaXMgNiBPY3RvYmVyIDIwMTQsIGlzIDYgT2N0b2JlciAxNDowMDowMCB0b2RheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzVG9kYXkobmV3IERhdGUoMjAxNCwgOSwgNiwgMTQsIDApKVxuICogLy89PiB0cnVlXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNUb2RheShkaXJ0eURhdGUpIHtcbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHJldHVybiBpc1NhbWVEYXkoZGlydHlEYXRlLCBEYXRlLm5vdygpKTtcbn0iLCJpbXBvcnQgaXNTYW1lV2VlayBmcm9tIFwiLi4vaXNTYW1lV2Vlay9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcblxuLyoqXG4gKiBAbmFtZSBpc1RoaXNXZWVrXG4gKiBAY2F0ZWdvcnkgV2VlayBIZWxwZXJzXG4gKiBAc3VtbWFyeSBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgc2FtZSB3ZWVrIGFzIHRoZSBjdXJyZW50IGRhdGU/XG4gKiBAcHVyZSBmYWxzZVxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogSXMgdGhlIGdpdmVuIGRhdGUgaW4gdGhlIHNhbWUgd2VlayBhcyB0aGUgY3VycmVudCBkYXRlP1xuICpcbiAqID4g4pqg77iPIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBpcyBub3QgcHJlc2VudCBpbiB0aGUgRlAgc3VibW9kdWxlIGFzXG4gKiA+IGl0IHVzZXMgYERhdGUubm93KClgIGludGVybmFsbHkgaGVuY2UgaW1wdXJlIGFuZCBjYW4ndCBiZSBzYWZlbHkgY3VycmllZC5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdG8gY2hlY2tcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc10gLSB0aGUgb2JqZWN0IHdpdGggb3B0aW9uc1xuICogQHBhcmFtIHtMb2NhbGV9IFtvcHRpb25zLmxvY2FsZT1kZWZhdWx0TG9jYWxlXSAtIHRoZSBsb2NhbGUgb2JqZWN0LiBTZWUgW0xvY2FsZV17QGxpbmsgaHR0cHM6Ly9kYXRlLWZucy5vcmcvZG9jcy9Mb2NhbGV9XG4gKiBAcGFyYW0gezB8MXwyfDN8NHw1fDZ9IFtvcHRpb25zLndlZWtTdGFydHNPbj0wXSAtIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrICgwIC0gU3VuZGF5KVxuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlIGlzIGluIHRoaXMgd2Vla1xuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKiBAdGhyb3dzIHtSYW5nZUVycm9yfSBgb3B0aW9ucy53ZWVrU3RhcnRzT25gIG11c3QgYmUgYmV0d2VlbiAwIGFuZCA2XG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRvZGF5IGlzIDI1IFNlcHRlbWJlciAyMDE0LCBpcyAyMSBTZXB0ZW1iZXIgMjAxNCBpbiB0aGlzIHdlZWs/XG4gKiBjb25zdCByZXN1bHQgPSBpc1RoaXNXZWVrKG5ldyBEYXRlKDIwMTQsIDgsIDIxKSlcbiAqIC8vPT4gdHJ1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0b2RheSBpcyAyNSBTZXB0ZW1iZXIgMjAxNCBhbmQgd2VlayBzdGFydHMgd2l0aCBNb25kYXlcbiAqIC8vIGlzIDIxIFNlcHRlbWJlciAyMDE0IGluIHRoaXMgd2Vlaz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzVGhpc1dlZWsobmV3IERhdGUoMjAxNCwgOCwgMjEpLCB7IHdlZWtTdGFydHNPbjogMSB9KVxuICogLy89PiBmYWxzZVxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1RoaXNXZWVrKGRpcnR5RGF0ZSwgb3B0aW9ucykge1xuICByZXF1aXJlZEFyZ3MoMSwgYXJndW1lbnRzKTtcbiAgcmV0dXJuIGlzU2FtZVdlZWsoZGlydHlEYXRlLCBEYXRlLm5vdygpLCBvcHRpb25zKTtcbn0iLCJpbXBvcnQgdG9EYXRlIGZyb20gXCIuLi90b0RhdGUvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIGlzUGFzdFxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgcGFzdD9cbiAqIEBwdXJlIGZhbHNlXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgcGFzdD9cbiAqXG4gKiA+IOKaoO+4jyBQbGVhc2Ugbm90ZSB0aGF0IHRoaXMgZnVuY3Rpb24gaXMgbm90IHByZXNlbnQgaW4gdGhlIEZQIHN1Ym1vZHVsZSBhc1xuICogPiBpdCB1c2VzIGBEYXRlLm5vdygpYCBpbnRlcm5hbGx5IGhlbmNlIGltcHVyZSBhbmQgY2FuJ3QgYmUgc2FmZWx5IGN1cnJpZWQuXG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZSAtIHRoZSBkYXRlIHRvIGNoZWNrXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gdGhlIGRhdGUgaXMgaW4gdGhlIHBhc3RcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0b2RheSBpcyA2IE9jdG9iZXIgMjAxNCwgaXMgMiBKdWx5IDIwMTQgaW4gdGhlIHBhc3Q/XG4gKiBjb25zdCByZXN1bHQgPSBpc1Bhc3QobmV3IERhdGUoMjAxNCwgNiwgMikpXG4gKiAvLz0+IHRydWVcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1Bhc3QoZGlydHlEYXRlKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICByZXR1cm4gdG9EYXRlKGRpcnR5RGF0ZSkuZ2V0VGltZSgpIDwgRGF0ZS5ub3coKTtcbn0iLCJpbXBvcnQgVG9kbyBmcm9tICcuL1RvZG8nO1xuaW1wb3J0IFByb2plY3RMaXN0IGZyb20gJy4vcHJvamVjdGxpc3QnO1xuaW1wb3J0IFByb2plY3QgZnJvbSAnLi9wcm9qZWN0JztcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4vc3RvcmFnZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxvYWRVaSgpIHtcbiAgLy8gY3JlYXRlIGRlZmF1bHQgb2JqZWN0c1xuICBjb25zdCBkZWZhdWx0UHJvamVjdCA9IG5ldyBQcm9qZWN0KCdkZWZhdWx0UHJvamVjdCcpO1xuICBsZXQgY3VycmVudFByb2plY3QgPSBkZWZhdWx0UHJvamVjdDtcbiAgY29uc3QgcHJvamVjdExpc3QgPSBuZXcgUHJvamVjdExpc3QoKTtcblxuICAvLyBjcmVhdGVzIHByb2plY3RQcm9tcHQgYW5kIGFwcGVuZHMgaXQgdG8gc2NyZWVuXG4gIGZ1bmN0aW9uIHByb21wdFByb2plY3QoKSB7XG4gICAgY29uc3QgcHJvamVjdFByb21wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHVzZXJQcm9qZWN0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VyUHJvamVjdHMnKTtcbiAgICBwcm9qZWN0UHJvbXB0LnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvamVjdFByb21wdCcpO1xuICAgIGNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkUHJvamVjdEJ0bicpO1xuICAgIHByb2plY3RQcm9tcHQuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1wcm9tcHQnKTtcbiAgICBwcm9qZWN0UHJvbXB0LmlubmVySFRNTCA9IGA8aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT1cIlwiIHBsYWNlaG9sZGVyPVwicHJvamVjdCB0aXRsZVwiIGlkPSdwcm9qZWN0VGl0bGUnPlxuICAgPGRpdj48YnV0dG9uIGlkPVwiYWRkXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTIzLCAyMzcsIDE1Nyk7XCI+QWRkPC9idXR0b24+XG4gICA8YnV0dG9uIGlkPVwiY2FuY2VsXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjQ3LCA5NSwgOTUpXCI+Q2FuY2VsPC9idXR0b24+PC9kaXY+YDtcbiAgICB1c2VyUHJvamVjdHMuYXBwZW5kKHByb2plY3RQcm9tcHQpO1xuICAgIGFkZFByb2plY3RCdG4uc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgIC8vIGFkZCBvciBjYW5jZWwgYnV0dG9uc1xuICAgIGNvbnN0IGFkZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQnKTtcbiAgICBjb25zdCBjYW5jZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsJyk7XG5cbiAgICBhZGQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhZGRQcm9qZWN0KTtcbiAgICBjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZW1vdmVQcm9qZWN0UHJvbXB0KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dQcm9qSW5Eb20ocHJvamVjdE5hbWUpIHtcbiAgICBjb25zdCB0b2RvU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrbGlzdCcpO1xuICAgIHRvZG9TZWN0aW9uLmlubmVySFRNTCA9ICcnO1xuICAgIGNvbnN0IHByb2p0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0VGl0bGUnKTtcbiAgICBwcm9qdGl0bGUuaW5uZXJUZXh0ID0gcHJvamVjdE5hbWU7XG4gIH1cblxuICAvLyBkZWxldGVzIGEgcHJvamVjdFxuICBmdW5jdGlvbiBkZWxldGVQcm9qZWN0KGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS14bWFyaycpKSB7XG4gICAgICBjb25zdCBwcm9qZWN0QnRuID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgY29uc3QgbnVtID0gcHJvamVjdEJ0bi5kYXRhc2V0LmluZGV4O1xuICAgICAgcHJvamVjdExpc3QucmVtb3ZlUHJvamVjdChudW0pO1xuICAgICAgcHJvamVjdEJ0bi5yZW1vdmUoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIC8vIHNob3cgZGVmYXVsdCBwcm9qZWN0XG4gICAgICBjdXJyZW50UHJvamVjdCA9IGRlZmF1bHRQcm9qZWN0O1xuICAgICAgc2hvd1Byb2pJbkRvbSgnSW5ib3gnKTtcbiAgICAgIGxvYWRUb2RvcyhjdXJyZW50UHJvamVjdC5hcnIpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGxvYWRzIHRvZG9zIG9mIGEgcHJvamVjdFxuICBmdW5jdGlvbiBsb2FkVG9kb3MoYXJyKSB7XG4gICAgYXJyLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgIC8vIGNyZWF0ZSB0b2RvIGNvbXBvbmVudFxuICAgICAgY29uc3QgdG9kb1NlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza2xpc3QnKTtcbiAgICAgIGNvbnN0IHRvZG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICB0b2RvSXRlbS5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0nKTtcbiAgICAgIHRvZG9JdGVtLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwibGVmdC10YXNrLXBhbmVsXCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLWNpcmNsZVwiPjwvaT48cCBjbGFzcz1cInRvZG8tdGl0bGVcIj4ke2VsZW1lbnQudGl0bGV9PC9wPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaW5wdXQtdGFzay1uYW1lXCIgZGF0YS1pbnB1dC10YXNrLW5hbWU9XCJcIj48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJyaWdodC10YXNrLXBhbmVsXCI+PHAgY2xhc3M9J2R1ZS1kYXRlJz4ke2VsZW1lbnQuZHVlRGF0ZX08L3A+PGlucHV0IHR5cGU9XCJkYXRlXCIgbmFtZT1cIlwiIGlkPVwiaW5wdXREdWVEYXRlXCIgY2xhc3M9XCJpbnB1dC1kYXRlXCIgZGF0YS1pbnB1dC1kYXRlPjxpIGNsYXNzPVwiZmEtc29saWQgZmEteG1hcmtcIj48L2k+PC9pPjwvZGl2PmA7XG4gICAgICBjb25zdCBpbmRleCA9IGN1cnJlbnRQcm9qZWN0LmFyci5sZW5ndGg7XG4gICAgICB0b2RvSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCBpbmRleCk7XG4gICAgICB0b2RvU2VjdGlvbi5hcHBlbmQodG9kb0l0ZW0pO1xuICAgICAgdG9kb0l0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVUb2RvKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIGNyZWF0ZXMgbmV3IHByb2plY3QgZnJvbSBwcm9qZWN0UHJvbXB0XG4gIGZ1bmN0aW9uIGFkZFByb2plY3QoKSB7XG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdFRpdGxlJykudmFsdWU7XG4gICAgaWYgKHRpdGxlID09PSB1bmRlZmluZWQgfHwgdGl0bGUgPT09ICcnKSB7XG4gICAgICBhbGVydChcIlByb2plY3QgbmFtZSBjYW4ndCBiZSBlbXB0eVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgcHJvamVjdFByb21wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0UHJvbXB0Jyk7XG4gICAgICBjb25zdCBuZXdQcm9qID0gbmV3IFByb2plY3QodGl0bGUpO1xuICAgICAgcHJvamVjdExpc3QuYWRkUHJvamVjdChuZXdQcm9qKTtcblxuICAgICAgLy8gY3JlYXRlIHByb2plY3QgYnV0dG9uXG4gICAgICBjb25zdCB1c2VyUHJvamVjdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlclByb2plY3RzJyk7XG4gICAgICBjb25zdCBwcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICBwcm9qZWN0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtYnV0dG9uJyk7XG4gICAgICBwcm9qZWN0QnV0dG9uLnN0eWxlLmlkID0gJ3Byb2plY3RCdXR0b24nO1xuICAgICAgcHJvamVjdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCBwcm9qZWN0TGlzdC5hcnIubGVuZ3RoIC0gMSk7XG4gICAgICBwcm9qZWN0QnV0dG9uLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwibGVmdC1wcm9qZWN0LXBhbmVsXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1saXN0XCI+PC9pPjxzcGFuPiZuYnNwJHt0aXRsZX08L3NwYW4+PC9kaXY+XG4gICAgIDxkaXYgY2xhc3M9XCJyaWdodC1wcm9qZWN0LXBhbmVsXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS14bWFya1wiPjwvaT48L2Rpdj5gO1xuICAgICAgdXNlclByb2plY3RzLmFwcGVuZENoaWxkKHByb2plY3RCdXR0b24pO1xuICAgICAgY29uc3QgYWRkUHJvamVjdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRQcm9qZWN0QnRuJyk7XG5cbiAgICAgIGFkZFByb2plY3RCdG4uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICBwcm9qZWN0UHJvbXB0LnJlbW92ZSgpO1xuXG4gICAgICAvLyBhZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICBwcm9qZWN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjdXJyZW50UHJvamVjdCA9IG5ld1Byb2o7XG4gICAgICAgIHNob3dQcm9qSW5Eb20obmV3UHJvai5uYW1lKTtcbiAgICAgICAgbG9hZFRvZG9zKGN1cnJlbnRQcm9qZWN0LmFycik7XG4gICAgICB9KTtcblxuICAgICAgcHJvamVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IGRlbGV0ZVByb2plY3QoZSk7IH0pO1xuXG4gICAgICAvKipcbiAgICAgIGNvbnN0IGNsb3NlUHJvamVjdEJ0bnMgPSBwcm9qZWN0QnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJy5mYS14bWFyaycpO1xuICAgICAgY29uc3QgY2xvc2VQcm9qZWN0QnRuID0gY2xvc2VQcm9qZWN0QnRuc1swXTtcbiAgICAgIGNsb3NlUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7IGRlbGV0ZVByb2plY3QoZSk7IH0pOyogKi9cbiAgICB9XG4gIH1cblxuICAvLyByZW1vdmVzIHByb2plY3QgcHJvbXB0XG4gIGZ1bmN0aW9uIHJlbW92ZVByb2plY3RQcm9tcHQoKSB7XG4gICAgY29uc3QgYWRkUHJvamVjdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRQcm9qZWN0QnRuJyk7XG4gICAgY29uc3QgcHJvamVjdFByb21wdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0UHJvbXB0Jyk7XG4gICAgcHJvamVjdFByb21wdC5yZW1vdmUoKTtcbiAgICBhZGRQcm9qZWN0QnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICB9XG5cbiAgLy8gQUREIEZVTkNUSU9OUyBGT1IgR0VUVElORyBUT0RPIElURU1TXG5cbiAgZnVuY3Rpb24gcHJvbXB0VG9kbygpIHtcbiAgICAvLyBjcmVhdGUgdG9kbyBwcm9tcHQgY29tcG9uZW50XG4gICAgY29uc3QgYWRkVG9kb0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRUb2RvQnRuJyk7XG4gICAgYWRkVG9kb0J0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIGNvbnN0IHRvZG9Qcm9tcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0b2RvUHJvbXB0LnNldEF0dHJpYnV0ZSgnaWQnLCAndG9kb1Byb21wdCcpO1xuICAgIHRvZG9Qcm9tcHQuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1wcm9tcHQnKTtcbiAgICB0b2RvUHJvbXB0LmlubmVySFRNTCA9IGA8aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT1cIlwiIHBsYWNlaG9sZGVyPVwidGFzayB0aXRsZVwiIGlkPSd0YXNrVGl0bGUnPlxuICAgIDxkaXY+PGJ1dHRvbiBpZD1cImFkZFwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogcmdiKDEyMywgMjM3LCAxNTcpO1wiPkFkZDwvYnV0dG9uPlxuICAgIDxidXR0b24gaWQ9XCJjYW5jZWxcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6IHJnYigyNDcsIDk1LCA5NSlcIj5DYW5jZWw8L2J1dHRvbj48L2Rpdj5gO1xuICAgIGNvbnN0IHRvZG9TZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tsaXN0Jyk7XG4gICAgdG9kb1NlY3Rpb24uYXBwZW5kQ2hpbGQodG9kb1Byb21wdCk7XG5cbiAgICBjb25zdCBhZGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkJyk7XG4gICAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbmNlbCcpO1xuXG4gICAgYWRkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWRkVG9kbyk7XG4gICAgY2FuY2VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlVG9kb1Byb21wdCk7XG4gIH1cblxuICAvLyBkZWxldGVzIHRvZG8gdGFza1xuICBmdW5jdGlvbiBkZWxldGVUb2RvKGUpIHtcbiAgICAvLyByZW1vdmUgdG9kbyBjb21wb25lbnRcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmYS14bWFyaycpKSB7XG4gICAgICBjb25zdCB0b2RvID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICAgICAgdG9kby5yZW1vdmUoKTtcbiAgICAgIC8vIHJlbW92ZSB0aGUgY29ycmVzcG9uZGluZyB0b2RvIG9iamVjdFxuICAgICAgY29uc3QgbnVtID0gdG9kby5kYXRhc2V0LmluZGV4O1xuICAgICAgY3VycmVudFByb2plY3QucmVtb3ZlVGFzayhudW0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIHVwZGF0ZXMgYSB0b2RvIGl0ZW1cbiAgZnVuY3Rpb24gdXBkYXRlVG9kbyhlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndG9kby10aXRsZScpIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZHVlLWRhdGUnKSkge1xuICAgICAgY29uc3QgdmFsdWUgPSBlLnRhcmdldDtcbiAgICAgIHZhbHVlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgIC8vIG1ha2UgaW5wdXQgZWxlbWVudCB2aXNpYmxlXG4gICAgICBjb25zdCBpbnB1dEl0ZW0gPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgICBpbnB1dEl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG5cbiAgICAgIC8vIGxpc3RlbiBmb3IgZW50ZXIgZXZlbnRcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICBjb25zdCBpbnB1dCA9IGlucHV0SXRlbS52YWx1ZTtcbiAgICAgICAgICBpZiAoaW5wdXQgPT09ICcnIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdWYWx1ZSBjYW5ub3QgYmUgZW1wdHknKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRJdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgdmFsdWUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBjb25zdCB7IGluZGV4IH0gPSB2YWx1ZS5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZGF0YXNldDtcbiAgICAgICAgICAgIHZhbHVlLmlubmVyVGV4dCA9IGlucHV0O1xuXG4gICAgICAgICAgICAvLyB1cGRhdGUgdG9kbyBpdGVtIHdpdGggbmV3IGRhdGFcbiAgICAgICAgICAgIGlmICh2YWx1ZS5jbGFzc0xpc3QuY29udGFpbnMoJ3RvZG8tdGl0bGUnKSkge1xuICAgICAgICAgICAgICBjdXJyZW50UHJvamVjdC5hcnJbaW5kZXhdLmVkaXRUaXRsZShpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUuY2xhc3NMaXN0LmNvbnRhaW5zKCdkdWUtZGF0ZScpKSB7XG4gICAgICAgICAgICAgIGN1cnJlbnRQcm9qZWN0LmFycltpbmRleF0uZWRpdER1ZURhdGUoaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gYWRkIGEgdG9kbyB0YXNrIHRvIHRoZSBjdXJyZW50IHByb2plY3RcbiAgZnVuY3Rpb24gYWRkVG9kbygpIHtcbiAgICBjb25zdCB0b2RvUHJvbXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZG9Qcm9tcHQnKTtcbiAgICBjb25zdCB0YXNrTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrVGl0bGUnKS52YWx1ZTtcbiAgICBpZiAodGFza05hbWUgPT09IHVuZGVmaW5lZCB8fCB0YXNrTmFtZSA9PT0gJycgfHwgdGFza05hbWUgPT09IG51bGwpIHtcbiAgICAgIGFsZXJ0KCdUYXNrIG5hbWUgY2Fubm90IGJlIGVtcHR5Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGNyZWF0ZSB0b2RvIG9iamVjdFxuICAgICAgY29uc3QgdG9kbyA9IFRvZG8odGFza05hbWUpO1xuICAgICAgY3VycmVudFByb2plY3QuYWRkVGFzayh0b2RvKTtcbiAgICAgIHRvZG9Qcm9tcHQucmVtb3ZlKCk7XG5cbiAgICAgIC8vIGNyZWF0ZSB0b2RvIGNvbXBvbmVudFxuICAgICAgY29uc3QgdG9kb0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIHRvZG9JdGVtLmNsYXNzTGlzdC5hZGQoJ3RvZG8taXRlbScpO1xuICAgICAgdG9kb0l0ZW0uaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9XCJsZWZ0LXRhc2stcGFuZWxcIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtY2lyY2xlXCI+PC9pPjxwIGNsYXNzPVwidG9kby10aXRsZVwiPiR7dGFza05hbWV9PC9wPjxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiaW5wdXQtdGFzay1uYW1lXCIgZGF0YS1pbnB1dC10YXNrLW5hbWU9XCJcIj48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJyaWdodC10YXNrLXBhbmVsXCI+PHAgY2xhc3M9XCJkdWUtZGF0ZVwiPk5vIERhdGU8L3A+PGlucHV0IHR5cGU9XCJkYXRlXCIgbmFtZT1cIlwiIGlkPVwiaW5wdXREdWVEYXRlXCIgY2xhc3M9XCJpbnB1dC1kYXRlXCIgZGF0YS1pbnB1dC1kYXRlPjxpIGNsYXNzPVwiZmEtc29saWQgZmEteG1hcmtcIj48L2k+PC9pPjwvZGl2PmA7XG4gICAgICBjb25zdCB0b2RvU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrbGlzdCcpO1xuICAgICAgY29uc3QgaW5kZXggPSBjdXJyZW50UHJvamVjdC5hcnIubGVuZ3RoIC0gMTtcbiAgICAgIHRvZG9JdGVtLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcsIGluZGV4KTtcbiAgICAgIHRvZG9TZWN0aW9uLmFwcGVuZCh0b2RvSXRlbSk7XG4gICAgICB0b2RvSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlbGV0ZVRvZG8pO1xuICAgICAgdG9kb0l0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB1cGRhdGVUb2RvKTtcbiAgICAgIGNvbnN0IGFkZFRvZG9CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkVG9kb0J0bicpO1xuICAgICAgYWRkVG9kb0J0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVUb2RvUHJvbXB0KCkge1xuICAgIGNvbnN0IHRvZG9Qcm9tcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kb1Byb21wdCcpO1xuICAgIHRvZG9Qcm9tcHQucmVtb3ZlKCk7XG4gICAgY29uc3QgYWRkVG9kb0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRUb2RvQnRuJyk7XG4gICAgYWRkVG9kb0J0bi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgfVxuXG4gIC8vIGdldCB0aGUgdG9kbyB0YXNrcyBpbiBpbmJveFxuICBmdW5jdGlvbiBnZXRJbmJveFRhc2tzKCkge1xuICAgIGxvYWRUb2RvcyhkZWZhdWx0UHJvamVjdC5hcnIpO1xuICB9XG5cbiAgLy8gZ2V0IHRoZSB0b2RvIHRhc2tzIG9mIHRoZSBkYXlcbiAgZnVuY3Rpb24gZ2V0RGF5c1Rhc2tzKCkge1xuICAgIC8vIGdldCBlYWNoIHByb2plY3RzIHRvZGF5IHRhc2tzXG4gICAgY29uc3QgYnVmZmVyID0gW107XG4gICAgcHJvamVjdExpc3QuYXJyLmZvckVhY2goKGxpc3QpID0+IHtcbiAgICAgIGJ1ZmZlci5wdXNoKGxpc3QuZ2V0VG9kYXlUYXNrcygpKTtcbiAgICB9KTtcblxuICAgIC8vIHNwbGl0IGFsbCBhcnJheXMgaW4gYnVmZmVyIGludG8gaW5kaXZpZHVhbCBpdGVtXG4gICAgY29uc3QgdG9kYXlUYXNrcyA9IFtdO1xuICAgIGJ1ZmZlci5mb3JFYWNoKChhcnIpID0+IHtcbiAgICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIHRvZGF5VGFza3MucHVzaChpdGVtKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGxvYWRUb2Rvcyh0b2RheVRhc2tzKTtcbiAgfVxuXG4gIC8qIC8vIFNBVklORyBUSEVNIEZPUiBGVVRVUkUgRkVBVFVSRVNcbiAgIC8vIGZ1bmN0aW9uIGdldCB0aGUgdG9kbyB0YXNrcyBvZiB0aGUgd2Vla1xuICBmdW5jdGlvbiBnZXRXZWVrc1Rhc2tzKCkge1xuICAgIC8vIGdldCBlYWNoIHByb2plY3RzIHRvZGF5IHRhc2tzXG4gICAgY29uc3QgYnVmZmVyID0gW107XG4gICAgcHJvamVjdExpc3QuYXJyLmZvckVhY2goKGxpc3QpID0+IHtcbiAgICAgIGJ1ZmZlci5wdXNoKGxpc3QuZ2V0V2Vla2x5VGFza3MoKSk7XG4gICAgfSk7XG5cbiAgICAvLyBzcGxpdCBhbGwgYXJyYXlzIGluIGJ1ZmZlciBpbnRvIGluZGl2aWR1YWwgaXRlbVxuICAgIGNvbnN0IHdlZWtzVGFza3MgPSBbXTtcbiAgICBidWZmZXIuZm9yRWFjaCgoYXJyKSA9PiB7XG4gICAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICB3ZWVrc1Rhc2tzLnB1c2goaXRlbSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBsb2FkVG9kb3Mod2Vla3NUYXNrcyk7XG4gIH0gKi9cblxuICAvLyBBREQgRVZFTlQgTElTVEVORVJTXG4gIGNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRkUHJvamVjdEJ0bicpO1xuICBhZGRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcHJvbXB0UHJvamVjdCk7XG5cbiAgY29uc3QgYWRkVG9kb0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRUb2RvQnRuJyk7XG4gIGFkZFRvZG9CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcm9tcHRUb2RvKTtcblxuICBjb25zdCBpbmJveEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmJveEJ0bicpO1xuICBpbmJveEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjdXJyZW50UHJvamVjdCA9IGRlZmF1bHRQcm9qZWN0O1xuICAgIHNob3dQcm9qSW5Eb20oJ0luYm94Jyk7XG4gICAgZ2V0SW5ib3hUYXNrcygpO1xuICB9KTtcblxuICAvKiogc2F2aW5nIGZvciBmdXR1cmUgZmVhdHVyZXNcbiAgICogY29uc3QgdG9kYXlCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kYXlCdG4nKTtcbiAgdG9kYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgc2hvd1Byb2pJbkRvbSgnVG9kYXknKTtcbiAgICBnZXREYXlzVGFza3MoKTtcbiAgfSk7XG5cbiAgY29uc3QgdGhpc1dlZWtCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGhpc1dlZWtCdG4nKTtcbiAgdGhpc1dlZWtCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgc2hvd1Byb2pJbkRvbSgnVGhpcyBXZWVrJyk7XG4gICAgZ2V0V2Vla3NUYXNrcygpO1xuICB9KTtcblxuICAgKi9cblxuICAvLyBERUZBVUxUIEJFSEFWSU9VUiBXSEVOIFdJTkRPVyBMT0FEU1xuICBzaG93UHJvakluRG9tKCdJbmJveCcpO1xuICBnZXRJbmJveFRhc2tzKCk7XG59XG4iLCJpbXBvcnQgbG9hZFVpIGZyb20gJy4vbW9kdWxlcy9kb21zdHVmZic7XG5cbmxvYWRVaSgpO1xuIl0sIm5hbWVzIjpbInRpdGxlIiwiZHVlRGF0ZSIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJjb21wbGV0ZWRTdGF0dXMiLCJlZGl0VGl0bGUiLCJuZXdUaXRsZSIsInRoaXMiLCJlZGl0RGVzY3JpcHRpb24iLCJuZXdEZXNjIiwiZWRpdFByaW9yaXR5IiwibmV3UHJpb3JpdHkiLCJlZGl0RHVlRGF0ZSIsIm5ld0R1ZURhdGUiLCJlZGl0Q29tcGxldGVkU3RhdHVzIiwibmV3Q29tcGxldGVkU3RhdHVzIiwiYXJyIiwiYWRkUHJvamVjdCIsInByb2plY3QiLCJwdXNoIiwicmVtb3ZlUHJvamVjdCIsImluZGV4Iiwic3BsaWNlIiwicmVxdWlyZWRBcmdzIiwicmVxdWlyZWQiLCJhcmdzIiwibGVuZ3RoIiwiVHlwZUVycm9yIiwiX3R5cGVvZiIsIm9iaiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJ0b0RhdGUiLCJhcmd1bWVudCIsImFyZ3VtZW50cyIsImFyZ1N0ciIsIk9iamVjdCIsInRvU3RyaW5nIiwiY2FsbCIsIkRhdGUiLCJnZXRUaW1lIiwiY29uc29sZSIsIndhcm4iLCJFcnJvciIsInN0YWNrIiwiTmFOIiwic3RhcnRPZkRheSIsImRpcnR5RGF0ZSIsImRhdGUiLCJzZXRIb3VycyIsImlzU2FtZURheSIsImRpcnR5RGF0ZUxlZnQiLCJkaXJ0eURhdGVSaWdodCIsImRhdGVMZWZ0U3RhcnRPZkRheSIsImRhdGVSaWdodFN0YXJ0T2ZEYXkiLCJ0b0ludGVnZXIiLCJkaXJ0eU51bWJlciIsIm51bWJlciIsIk51bWJlciIsImlzTmFOIiwiTWF0aCIsImNlaWwiLCJmbG9vciIsImRlZmF1bHRPcHRpb25zIiwiZ2V0RGVmYXVsdE9wdGlvbnMiLCJzdGFydE9mV2VlayIsIm9wdGlvbnMiLCJfcmVmIiwiX3JlZjIiLCJfcmVmMyIsIl9vcHRpb25zJHdlZWtTdGFydHNPbiIsIl9vcHRpb25zJGxvY2FsZSIsIl9vcHRpb25zJGxvY2FsZSRvcHRpbyIsIl9kZWZhdWx0T3B0aW9ucyRsb2NhbCIsIl9kZWZhdWx0T3B0aW9ucyRsb2NhbDIiLCJ3ZWVrU3RhcnRzT24iLCJsb2NhbGUiLCJSYW5nZUVycm9yIiwiZGF5IiwiZ2V0RGF5IiwiZGlmZiIsInNldERhdGUiLCJnZXREYXRlIiwiaXNTYW1lV2VlayIsImRhdGVMZWZ0U3RhcnRPZldlZWsiLCJkYXRlUmlnaHRTdGFydE9mV2VlayIsInByb2plY3ROYW1lIiwibmFtZSIsImFkZFRhc2siLCJ0b2RvIiwicmVtb3ZlVGFzayIsImdldFRvZGF5VGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwibm93IiwiaXNUb2RheSIsImdldFdlZWtseVRhc2tzIiwiaXNUaGlzV2VlayIsInBhc3REdWVUYXNrcyIsImlzUGFzdCIsImRlZmF1bHRQcm9qZWN0IiwiY3VycmVudFByb2plY3QiLCJwcm9qZWN0TGlzdCIsInNob3dQcm9qSW5Eb20iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwiaW5uZXJUZXh0IiwibG9hZFRvZG9zIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJ0b2RvU2VjdGlvbiIsInRvZG9JdGVtIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZWxldGVUb2RvIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJhbGVydCIsInByb2plY3RQcm9tcHQiLCJuZXdQcm9qIiwidXNlclByb2plY3RzIiwicHJvamVjdEJ1dHRvbiIsInN0eWxlIiwiaWQiLCJhcHBlbmRDaGlsZCIsImRpc3BsYXkiLCJyZW1vdmUiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJwcm9qZWN0QnRuIiwicGFyZW50RWxlbWVudCIsIm51bSIsImRhdGFzZXQiLCJzdG9wUHJvcGFnYXRpb24iLCJkZWxldGVQcm9qZWN0IiwicmVtb3ZlUHJvamVjdFByb21wdCIsImFkZFByb2plY3RCdG4iLCJ1cGRhdGVUb2RvIiwiaW5wdXRJdGVtIiwicXVlcnlTZWxlY3RvciIsImV2ZW50Iiwia2V5IiwiaW5wdXQiLCJhZGRUb2RvIiwidG9kb1Byb21wdCIsInRhc2tOYW1lIiwiVG9kbyIsInJlbW92ZVRvZG9Qcm9tcHQiLCJnZXRJbmJveFRhc2tzIiwiY2FuY2VsIiwibG9hZFVpIl0sInNvdXJjZVJvb3QiOiIifQ==